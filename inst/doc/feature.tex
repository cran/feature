\documentclass[a4paper,11pt]{article}

\usepackage{natbib,anysize}
\marginsize{3cm}{3cm}{3cm}{3cm}

\renewcommand{\today}{\begingroup
\number \day\space  \ifcase \month \or January\or February\or March\or 
April\or May\or June\or July\or August\or September\or October\or 
November\or December\fi 
\space  \number \year \endgroup}

%\oddsidemargin=0.0mm
%\evensidemargin=0.0mm
%\textwidth=158.75mm             % A4 paper is 8.25in wide
%\topmargin=-2.54mm
%\textheight=236.2mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Change this for a different vignette
%\VignetteIndexEntry{feature} 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\title{feature: an R package for feature significance for multivariate
kernel density estimation}
\author{Tarn Duong}



%\SweaveOpts{}
\usepackage{/usr/local/lib64/R/share/texmf/Sweave}
\begin{document}


\maketitle

\section{Introduction}

Feature significance is an extension of kernel density estimation
which is used to establish the statistical significance of 
features (e.g. local modes). See \citet*{chaudhuri99} for 1-dimensional data,
\citet*{godtliebsen02} for  2-dimensional data and \citet*{duong07}
for 3- and 4-dimensional data. \texttt{feature} is an R package for 
feature significance for 1- to 4-dimensional data.
  There is one main function in this package, \texttt{featureSignif}. 
It has a range of options which allow
the user to compute and display kernel density estimates, significant gradient
and significant curvature regions. Significant gradient and/or
curvature regions often correspond to significant features. 
In this vignette we focus on 1- and 2-dimensional data.


\section{Univariate data example}
The \texttt{earthquake} data set is contained in 
\texttt{feature}. It contains 510 observations, each consisting
of measurements of an earthquake beneath the Mt St Helens volcano.
The first is the longitude (in degrees, where a negative number
indicates west of the International Date Line), second  is
the latitude (in degrees, where a positive number indicates north of
the Equator) and the third  is the depth (in km, where a
negative number indicates below the Earth's surface).
For the univariate example, we take the log(--depth)
as our variable of interest. 
The kernel density estimate with bandwidth 0.1 is the orange curve. 
Superimposed in green 
are the sections of this density estimate which have significant gradient
(i.e. significantly different from zero). The rug plot is 
the log(--depth) measurements.

\setkeys{Gin}{width=0.5\textwidth}
\begin{center}
\begin{Schunk}
\begin{Sinput}
> library(feature)
> data(earthquake)
> eq3 <- -log10(-earthquake[, 3])
> featureSignif(eq3, addData = TRUE, addSignifGradRegion = TRUE, 
+     xlab = "-log(-depth)", bw = 0.1)
\end{Sinput}
\end{Schunk}
\includegraphics{feature-001}
\end{center}


Below is the same kernel density estimate and 
significant gradient region plot along with the SiZer plot of \citet*{chaudhuri99}.
In the SiZer plot, blue indicates significantly increasing gradient,
red is significantly decreasing gradient, purple is non-significant gradient
and grey is data too sparse for reliable estimation. The horizontal black line
is for the bandwidth $0.1$.

\setkeys{Gin}{width=0.55\textwidth}
\begin{Schunk}
\begin{Sinput}
> featureSignif(eq3, addSignifGradRegion = TRUE, xlab = "-log(-depth)", 
+     bw = 0.1)
> featureSignif(eq3, plotSiZer = TRUE, xlab = "-log(-depth)")
> lines(c(-2, 2), c(log(0.1), log(0.1)))
\end{Sinput}
\end{Schunk}
\begin{center}
\includegraphics{feature-003}
%\caption{Univariate data: significant gradient regions and SiZer plot}
%\label{fig:fs2}
\end{center}

\section{Bivariate data example}

For bivariate data, we look at an Old Faithful geyser data set,
in the \texttt{MASS} library. The
horizontal axis is the waiting time (in minutes) between two eruptions, and
the vertical axis is the duration time (in minutes) of an eruption.
Below is a kernel density estimate with
bandwidth (4.5, 0.37) with %the significant gradient regions in green
the significant curvature regions in blue superimposed.
%\begin{figure}[!ht]
\begin{center}
\begin{Schunk}
\begin{Sinput}
> library(MASS)
> data(geyser)
> featureSignif(geyser, addSignifCurvRegion = TRUE, bw = c(4.5, 
+     0.37))
\end{Sinput}
\end{Schunk}
\includegraphics{feature-005}
\end{center}
%\caption{Bivariate data: significant gradient and curvature regions}
%\label{fig:fs4}
%\end{figure}

A variation on plotting the significant regions is to plot the data points which
fall inside these regions:
%%significant gradient data points are in green,  
significant curvature data points are in blue.
%\begin{figure}[!ht]
\begin{center}
\begin{Schunk}
\begin{Sinput}
> fs <- featureSignif(geyser, addSignifCurvData = TRUE, bw = c(4.5, 
+     0.37))
\end{Sinput}
\end{Schunk}
\includegraphics{feature-007}
%\caption{Bivariate data: significant gradient and curvature data points}
%\label{fig:fs5}
\end{center}
%\end{figure}

Usually \texttt{featureSignif} returns invisibly to the command line 
but in this example, we assigned it to the variable \texttt{fs}.
\begin{Schunk}
\begin{Sinput}
> names(fs)
\end{Sinput}
\begin{Soutput}
[1] "x"              "bw"             "fhat"           "curv"          
[5] "curvData"       "curvDataPoints"
\end{Soutput}
\end{Schunk}
where \texttt{x} is the data, \texttt{bw} is the bandwidth, \texttt{fhat\$est} 
is the kernel density estimate
on the grid \texttt{fhat\$x.grid}, 
%\texttt{grad} is the logical matrix indicating signficant gradient on a grid, 
\texttt{curv} is the logical matrix indicating signficant curvature on a grid,
%\texttt{gradData} is the logical vector indicating signficant gradient data points and 
\texttt{curvData} is the logical vector indicating signficant curvature data points.
So the points with significant curvature are 
\begin{Schunk}
\begin{Sinput}
> fs$x[fs$curvData, ]
\end{Sinput}
\end{Schunk}
\begin{Schunk}
\begin{Soutput}
  waiting duration
1      80 4.016667
4      80 4.000000
5      75 4.000000
6      77 2.000000
9      77 2.033333
\end{Soutput}
\end{Schunk}
\vdots

\section{Functionality not documented in this vignette}

\texttt{feature} includes 
feature significance for 3- and 4-dimensional
data. However the displays in these dimensions rely on the rgl engine
\citep{rgl} which is not quite integrated with \texttt{Sweave} 
so we have excluded examples for the time being. See 
the example code in \texttt{?featureSignif}.   

These examples have used \texttt{featureSignif} in its non-interactive
mode i.e. where the user supplies a particular value of the bandwidth. 
In its interactive mode, the user is able to choose a
bandwidth from a range of bandwidths and the significant features are
displayed in real-time.
Again it's not possible to illustrate this in this vignette,
see \texttt{?featureSignif}.   
 

\bibliographystyle{apalike}

%\bibliography{/c/tduong/home/research/references}

\begin{thebibliography}{}

\bibitem[Adler and Murdoch, 2006]{rgl}
Adler, D. and Murdoch, D. (2006).
\newblock {\em rgl: 3D visualization device system (OpenGL)}.
\newblock R package version 0.67-2.

\bibitem[Chaudhuri and Marron, 1999]{chaudhuri99}
Chaudhuri, P. and Marron, J.~S. (1999).
\newblock Si{Z}er for exploration of structures in curves.
\newblock {\em Journal of the American Statistical Association}, \textbf{94}, 807--823.

\bibitem[Duong et~al., 2007]{duong07}
Duong, T., Cowling, A., Koch, I., and Wand, M.~P. (2007).
\newblock Feature significance for multivariate kernel density estimation.
\newblock Submitted.

\bibitem[Godtliebsen et~al., 2002]{godtliebsen02}
Godtliebsen, F., Marron, J.~S., and Chaudhuri, P. (2002).
\newblock Significance in scale space for bivariate density estimation.
\newblock {\em Journal of Computational and Graphical Statistics}, \textbf{11}, 1--21.

\end{thebibliography}

\end{document}
